ggplot(linelist)+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
View(summary)
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
end = linelist %>% filter(time == max(time))
ggplot(end)+geom_density(aes(x=normalisedViralLoad))
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
linelist %>% group_by(behaviour) %>% count()
ggplot(linelist %>% filter(normalisedSeverity > 0))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
linelist %>% group_by(behaviour) %>% count()
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
summary %>% group_by(policy) %>% count()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
knitr::opts_chunk$set(echo = TRUE)
here::i_am("in-host-model.qmd")
library(tidyverse)
# install.packages(
#   c("odin","odin.dust","dust"),
#   repos = c("https://mrc-ide.r-universe.dev", "https://cloud.r-project.org"))
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
summary %>% group_by(policy) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
summary %>% group_by(policy) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
linelist %>% group_by(behaviour) %>% count()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
summary %>% group_by(policy) %>% count()
ggplot(summary,aes(x=time,colour=as.factor(policy)))+geom_area()
ggplot(summary,aes(x=time,colour=as.factor(policy),y=1))+geom_area()
ggplot(summary,aes(x=time,fill=as.factor(policy),y=1))+geom_bar()
ggplot(summary,aes(x=time,fill=as.factor(policy),y=1))+geom_bar(stat="identity")
ggplot(summary,aes(x=time,fill=as.factor(behaviour)))+geom_area()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour)))+geom_area()
ggplot(linelist,aes(x=time,fill=as.factor(behaviour)))+geom_area(stat="count")
ggplot(linelist,aes(x=time,fill=as.factor(behaviour)))+geom_bar()
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
p = 0.75
mod = 1.1
mod = seq(0.2,1.8,0.1)
1-(1-p)^mod
mod = seq(1,0,-0.02)
1-(1-p)^mod
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
0.99*0.01
sqrt(0.99*0.01)
sd = sqrt(0.99*0.01)
mean = 0.99
tmp = mean*(1-mean)/(sd*sd)-1
alpha = tmp*mean
beta = tmp*(1-mean)
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
knitr::opts_chunk$set(echo = TRUE)
here::i_am("in-host-model.qmd")
library(tidyverse)
# install.packages(
#   c("odin","odin.dust","dust"),
#   repos = c("https://mrc-ide.r-universe.dev", "https://cloud.r-project.org"))
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
period = 7
p = exp(log(0.5)/period)
p^7
logit= function(p) {return(log(p/(1-p)))}
invLogit= function(x) {return(1/(1+exp(-x)))}
median = seq(0.025,0.975,0.05)
scale = 0.1
mu = logit(median);
#sigma = scale*(exp((abs(mu)^(3/4))))
sigma = scale*(2+(abs(mu)^(7/4)))
tmp = bind_rows(lapply(seq_along(mu), \(i) tibble::tibble(
q = seq(0.01,0.99,0.01),
x = invLogit(qnorm(p = seq(0.01,0.99,0.01))*sigma[i]+mu[i]),
p = (q-lag(q))/(x-lag(x)),
median = invLogit(mu[i])
)))
ggplot(tmp,aes(x=x,y=p,colour=as.factor(median)))+geom_line()
tmp2 = tmp %>% group_by(median) %>%
mutate(dx=x-lag(x)) %>%
summarise(
mean = sum(x*p*dx,na.rm = TRUE),
sd = sum((x-mean)^2*p*dx,na.rm = TRUE)
)
ggplot(tmp2,aes(x=median,y=mean))+geom_point()
ggplot(tmp2,aes(x=median,y=sd))+geom_point()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
knitr::opts_chunk$set(echo = TRUE)
here::i_am("in-host-model.qmd")
library(tidyverse)
# install.packages(
#   c("odin","odin.dust","dust"),
#   repos = c("https://mrc-ide.r-universe.dev", "https://cloud.r-project.org"))
period = 7
p = exp(log(0.5)/period)
p^7
logit= function(p) {return(log(p/(1-p)))}
invLogit= function(x) {return(1/(1+exp(-x)))}
median = seq(0.025,0.975,0.05)
scale = 0.1
mu = logit(median);
#sigma = scale*(exp((abs(mu)^(3/4))))
sigma = scale*(2+(abs(mu)^(7/4)))
tmp = bind_rows(lapply(seq_along(mu), \(i) tibble::tibble(
q = seq(0.01,0.99,0.01),
x = invLogit(qnorm(p = seq(0.01,0.99,0.01))*sigma[i]+mu[i]),
p = (q-lag(q))/(x-lag(x)),
median = invLogit(mu[i])
)))
ggplot(tmp,aes(x=x,y=p,colour=as.factor(median)))+geom_line()
tmp2 = tmp %>% group_by(median) %>%
mutate(dx=x-lag(x)) %>%
summarise(
mean = sum(x*p*dx,na.rm = TRUE),
sd = sum((x-mean)^2*p*dx,na.rm = TRUE)
)
ggplot(tmp2,aes(x=median,y=mean))+geom_point()
ggplot(tmp2,aes(x=median,y=sd))+geom_point()
noise = (runif(10000)-(1-sensitivity))/(sensitivity+specificity-1)
sensitivity = 0.8
specificity = 0.95
min = (sensitivity-1)/(specificity + sensitivity - 1)
max = (sensitivity)/(specificity + sensitivity - 1)
# sens
sum(runif(10000,min,max)+1 > 1)/10000
# spec
sum(runif(10000,min,max) < 1)/10000
noise = (runif(10000)-(1-sensitivity))/(sensitivity+specificity-1)
# sens
sum(1 + noise > 1)/10000
# spec
sum( noise < 1)/10000
period = 7
p = exp(log(0.5)/period)
p^7
logit = function(p) {return(log(p/(1-p)))}
expit = function(x) {return(1/(1+exp(-x)))}
OR = 1.5
p = seq(0.1,0.9,0.1)
expit(logit(p) + log(OR))
scaled_p = expit(logit(p) + log(OR))
scaled_p / p
scaled_p
p
1-((1-p)^1.5)
scaled_p
OR = 2
p = seq(0.1,0.9,0.1)
scaled_p = expit(logit(p) + log(OR))
1-((1-p)^OR)
scaled_p
scaled_p2 = 1-((1-p)^OR)
p/(1-p)
scaled_p/(1-scaled_p)
scaled_p2/(1-scaled_p2)
p/(1-p)
scaled_p2/(1-scaled_p2)
scaled_p/(1-scaled_p)
p/scaled_p2
log(p)/log(scaled_p2)
expit(seq(-1,1,0.1))
expit(seq(-1,1,0.1)/2)
expit(logit(0.01)+seq(-1,1,0.1)/2)
expit(logit(0.01)+seq(-1,1,0.1))
expit(logit(0.01)+seq(-1,1,0.1)/2)
expit(logit(0.01)+seq(-1,1,0.1))
a = expit(logit(0.01) + seq(-1,1,0.1) * 0.5)
b = expit(logit(0.01) + seq(-1,1,0.1))
a/b
log(a/b)
a-b
logit(a/b)
log(a/b)
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
View(summary)
expit(logit(0.25) + log(1))
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
0.25*0.25
0.5*0.5
1-(1-0.5)*(1-0.5)
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
linelist = readr::read_csv("~/tmp/linelist.csv")
ggplot(linelist,aes(x=time,y=normalisedViralLoad,group=personId))+geom_line(alpha=0.01)
ggplot(linelist %>% group_by(time) %>% summarise(virionExposure=mean(virionExposure)),aes(x=time,y=virionExposure))+geom_line()
ggplot(linelist %>% filter(virionExposure > 0))+geom_density(aes(x=virionExposure))
ggplot(linelist %>% filter(normalisedSeverity > 0) %>% group_by(personId) %>% summarise(normalisedSeverity = max(normalisedSeverity)))+geom_density(aes(x=normalisedSeverity))
ggplot(linelist,aes(x=time,fill=as.factor(behaviour),colour=as.factor(behaviour)))+geom_bar()
linelist %>% group_by(behaviour) %>% count()
summary = readr::read_csv("~/tmp/summary.csv")
ggplot(summary,aes(x=time,y=incidence))+geom_line()
ggplot(summary,aes(x=time,y=infectedCount))+geom_line()
ggplot(summary,aes(x=time,y=averageMobility))+geom_line()
ggplot(summary,aes(x=time,y=averageCompliance))+geom_line()
ggplot(summary,aes(x=time,y=presumedTestPositivePrevalence))+geom_line()
ggplot(summary,aes(x=time,fill=as.factor(policy),colour=as.factor(policy),y=1))+geom_bar(stat="identity")
summary %>% group_by(policy) %>% count()
