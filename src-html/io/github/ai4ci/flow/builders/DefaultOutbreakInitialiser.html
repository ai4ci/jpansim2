<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (17) -->
<title>Source code</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="source: package: io.github.ai4ci.flow.builders, interface: DefaultOutbreakInitialiser">
<meta name="generator" content="javadoc/SourceToHTMLConverter">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body class="source-page">
<main role="main">
<div class="source-container">
<pre><span class="source-line-no">001</span><span id="line-1">package io.github.ai4ci.flow.builders;</span>
<span class="source-line-no">002</span><span id="line-2"></span>
<span class="source-line-no">003</span><span id="line-3">import io.github.ai4ci.abm.ImmutableOutbreakState;</span>
<span class="source-line-no">004</span><span id="line-4">import io.github.ai4ci.abm.Outbreak;</span>
<span class="source-line-no">005</span><span id="line-5">import io.github.ai4ci.config.execution.ExecutionConfiguration;</span>
<span class="source-line-no">006</span><span id="line-6">import io.github.ai4ci.util.Sampler;</span>
<span class="source-line-no">007</span><span id="line-7"></span>
<span class="source-line-no">008</span><span id="line-8">/**</span>
<span class="source-line-no">009</span><span id="line-9"> * Default outbreak initialisation behaviour.</span>
<span class="source-line-no">010</span><span id="line-10"> *</span>
<span class="source-line-no">011</span><span id="line-11"> * &lt;p&gt;</span>
<span class="source-line-no">012</span><span id="line-12"> * This interface provides a focussed default implementation that produces the</span>
<span class="source-line-no">013</span><span id="line-13"> * runtime {@link ImmutableOutbreakState} from a baselined {@link Outbreak} and</span>
<span class="source-line-no">014</span><span id="line-14"> * its {@link io.github.ai4ci.config.execution.ExecutionConfiguration}. The</span>
<span class="source-line-no">015</span><span id="line-15"> * default method encapsulates straightforward mappings from execution</span>
<span class="source-line-no">016</span><span id="line-16"> * configuration priors into the outbreak runtime state (for example</span>
<span class="source-line-no">017</span><span id="line-17"> * transmissibility modifiers, presumed incubation and infectious periods, and</span>
<span class="source-line-no">018</span><span id="line-18"> * screening/triggers).</span>
<span class="source-line-no">019</span><span id="line-19"> *</span>
<span class="source-line-no">020</span><span id="line-20"> * &lt;p&gt;</span>
<span class="source-line-no">021</span><span id="line-21"> * Role in composition: this interface is designed to be composed into higher</span>
<span class="source-line-no">022</span><span id="line-22"> * level builders such as</span>
<span class="source-line-no">023</span><span id="line-23"> * {@link io.github.ai4ci.flow.builders.DefaultModelBuilder}. The</span>
<span class="source-line-no">024</span><span id="line-24"> * {@code DefaultModelBuilder} implements this interface and delegates outbreak</span>
<span class="source-line-no">025</span><span id="line-25"> * initialisation to the default implementation using</span>
<span class="source-line-no">026</span><span id="line-26"> * {@code DefaultOutbreakInitialiser.super.initialiseOutbreak(...)}. This</span>
<span class="source-line-no">027</span><span id="line-27"> * explicit delegation keeps the wiring declarative and allows alternative</span>
<span class="source-line-no">028</span><span id="line-28"> * initialisation strategies to be substituted by implementing this interface</span>
<span class="source-line-no">029</span><span id="line-29"> * differently or by overriding the delegation point in a subclass of the model</span>
<span class="source-line-no">030</span><span id="line-30"> * builder.</span>
<span class="source-line-no">031</span><span id="line-31"> *</span>
<span class="source-line-no">032</span><span id="line-32"> * &lt;p&gt;</span>
<span class="source-line-no">033</span><span id="line-33"> * Rationale and extension points: keeping outbreak initialisation as a small,</span>
<span class="source-line-no">034</span><span id="line-34"> * composable default makes the code easier to test and extend. If a simulation</span>
<span class="source-line-no">035</span><span id="line-35"> * requires a custom outbreak initial state (for example different policy</span>
<span class="source-line-no">036</span><span id="line-36"> * parameters or additional runtime metrics), implementers should either provide</span>
<span class="source-line-no">037</span><span id="line-37"> * an alternative implementation of this interface or subclass</span>
<span class="source-line-no">038</span><span id="line-38"> * {@code DefaultModelBuilder} and override</span>
<span class="source-line-no">039</span><span id="line-39"> * {@link DefaultModelBuilder#initialiseOutbreak(ImmutableOutbreakState.Builder, Outbreak, Sampler)}.</span>
<span class="source-line-no">040</span><span id="line-40"> * Avoid placing heavy IO or long running tasks inside this method unless the</span>
<span class="source-line-no">041</span><span id="line-41"> * caller (the model builder) is explicitly designed to parallelise or manage</span>
<span class="source-line-no">042</span><span id="line-42"> * such work; prefer to perform expensive data preparation in the setup stage or</span>
<span class="source-line-no">043</span><span id="line-43"> * during baselining.</span>
<span class="source-line-no">044</span><span id="line-44"> *</span>
<span class="source-line-no">045</span><span id="line-45"> * &lt;p&gt;</span>
<span class="source-line-no">046</span><span id="line-46"> * Sequencing expectations: the default implementation assumes the outbreak has</span>
<span class="source-line-no">047</span><span id="line-47"> * already been baselined (see {@link DefaultOutbreakBaseliner}) and that</span>
<span class="source-line-no">048</span><span id="line-48"> * demographic and network structures are in place; it therefore should be</span>
<span class="source-line-no">049</span><span id="line-49"> * invoked only after baselining has completed.</span>
<span class="source-line-no">050</span><span id="line-50"> *</span>
<span class="source-line-no">051</span><span id="line-51"> * @author Rob Challen</span>
<span class="source-line-no">052</span><span id="line-52"> */</span>
<span class="source-line-no">053</span><span id="line-53">public interface DefaultOutbreakInitialiser {</span>
<span class="source-line-no">054</span><span id="line-54"></span>
<span class="source-line-no">055</span><span id="line-55">        /**</span>
<span class="source-line-no">056</span><span id="line-56">         * Build the initial runtime outbreak state.</span>
<span class="source-line-no">057</span><span id="line-57">         *</span>
<span class="source-line-no">058</span><span id="line-58">         * &lt;p&gt;</span>
<span class="source-line-no">059</span><span id="line-59">         * The default implementation maps a small set of values from the</span>
<span class="source-line-no">060</span><span id="line-60">         * {@link ExecutionConfiguration} into the outbreak state builder. These</span>
<span class="source-line-no">061</span><span id="line-61">         * values are intended as conservative runtime priors used by the simulator</span>
<span class="source-line-no">062</span><span id="line-62">         * (for example assumed incubation and infectious durations used by detection</span>
<span class="source-line-no">063</span><span id="line-63">         * and screening logic).</span>
<span class="source-line-no">064</span><span id="line-64">         *</span>
<span class="source-line-no">065</span><span id="line-65">         * &lt;p&gt;</span>
<span class="source-line-no">066</span><span id="line-66">         * When composed into</span>
<span class="source-line-no">067</span><span id="line-67">         * {@link io.github.ai4ci.flow.builders.DefaultModelBuilder} this method is</span>
<span class="source-line-no">068</span><span id="line-68">         * invoked via explicit delegation. Implementers replacing the default should</span>
<span class="source-line-no">069</span><span id="line-69">         * preserve the contract that the outbreak is baselined and that the returned</span>
<span class="source-line-no">070</span><span id="line-70">         * object contains global runtime priors only; any additional computed</span>
<span class="source-line-no">071</span><span id="line-71">         * aggregates should be added in a well documented way.</span>
<span class="source-line-no">072</span><span id="line-72">         *</span>
<span class="source-line-no">073</span><span id="line-73">         * @param builder  builder for {@link ImmutableOutbreakState}</span>
<span class="source-line-no">074</span><span id="line-74">         * @param outbreak the baselined outbreak used as input</span>
<span class="source-line-no">075</span><span id="line-75">         * @param sampler  a sampler available for stochastic choices during</span>
<span class="source-line-no">076</span><span id="line-76">         *                 initialisation</span>
<span class="source-line-no">077</span><span id="line-77">         * @return a built {@link ImmutableOutbreakState} containing runtime priors</span>
<span class="source-line-no">078</span><span id="line-78">         */</span>
<span class="source-line-no">079</span><span id="line-79">        default ImmutableOutbreakState initialiseOutbreak(</span>
<span class="source-line-no">080</span><span id="line-80">                        ImmutableOutbreakState.Builder builder, Outbreak outbreak,</span>
<span class="source-line-no">081</span><span id="line-81">                        Sampler sampler</span>
<span class="source-line-no">082</span><span id="line-82">        ) {</span>
<span class="source-line-no">083</span><span id="line-83">                ExecutionConfiguration config = outbreak.getExecutionConfiguration();</span>
<span class="source-line-no">084</span><span id="line-84">                builder.setTransmissibilityModifier(1.0)</span>
<span class="source-line-no">085</span><span id="line-85">                                .setContactDetectedProbability(</span>
<span class="source-line-no">086</span><span id="line-86">                                                config.getContactDetectedProbability()</span>
<span class="source-line-no">087</span><span id="line-87">                                )</span>
<span class="source-line-no">088</span><span id="line-88">                                .setPresumedInfectiousPeriod(</span>
<span class="source-line-no">089</span><span id="line-89">                                                config.getInitialEstimateInfectionDuration().intValue()</span>
<span class="source-line-no">090</span><span id="line-90">                                )</span>
<span class="source-line-no">091</span><span id="line-91">                                .setPresumedIncubationPeriod(</span>
<span class="source-line-no">092</span><span id="line-92">                                                config.getInitialEstimateIncubationPeriod().intValue()</span>
<span class="source-line-no">093</span><span id="line-93">                                )</span>
<span class="source-line-no">094</span><span id="line-94">                                .setPresumedSymptomSensitivity(</span>
<span class="source-line-no">095</span><span id="line-95">                                                config.getInitialEstimateSymptomSensitivity()</span>
<span class="source-line-no">096</span><span id="line-96">                                )</span>
<span class="source-line-no">097</span><span id="line-97">                                .setPresumedSymptomSpecificity(</span>
<span class="source-line-no">098</span><span id="line-98">                                                config.getInitialEstimateSymptomSpecificity()</span>
<span class="source-line-no">099</span><span id="line-99">                                ).setScreeningProbability(config.getInitialScreeningProbability())</span>
<span class="source-line-no">100</span><span id="line-100">                                .setTriggerValue(config.getLockdownTriggerValue());</span>
<span class="source-line-no">101</span><span id="line-101"></span>
<span class="source-line-no">102</span><span id="line-102">                return builder.build();</span>
<span class="source-line-no">103</span><span id="line-103">        }</span>
<span class="source-line-no">104</span><span id="line-104">}</span>




























































</pre>
</div>
</main>
</body>
</html>
