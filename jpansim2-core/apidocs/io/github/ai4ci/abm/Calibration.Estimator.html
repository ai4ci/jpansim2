<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (17) on Fri Feb 13 22:23:04 UTC 2026 -->
<title>Calibration.Estimator (jpansim2 0.3.1 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2026-02-13">
<meta name="description" content="declaration: package: io.github.ai4ci.abm, class: Calibration, class: Estimator">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<div class="about-language"><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/Calibration.Estimator.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">io.github.ai4ci.abm</a></div>
<h1 title="Class Calibration.Estimator" class="title">Class Calibration.Estimator</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">io.github.ai4ci.abm.Calibration.Estimator</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>Enclosing class:</dt>
<dd><a href="Calibration.html" title="class in io.github.ai4ci.abm">Calibration</a></dd>
</dl>
<hr>
<object type="image/svg+xml" data="Calibration.Estimator.svg"  style="max-width:60%;float:right;"></object>
<div class="type-signature"><span class="modifiers">public static class </span><span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-75">Calibration.Estimator</a></span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">An optimized estimator for the expected probability of transmission across
 a social network edge given a transmission parameter and viral load
 profiles.

 <p>
 This class precomputes a quartic polynomial approximation of the expected
 transmission probability by leveraging the structure of the Poisson
 binomial distribution formed by independent daily exposure risks over an
 infection period. For each viral load profile, the excess viral load
 (above threshold 1.0) is summarized into raw moments \( B_1 \)–\( B_4 \),
 where \( B_n = \sum_t (\delta_t)^n \) and \( \delta_t = \max(v_t - 1, 0)
 \).

 <p>
 The probability of at least one exposure is \( 1 - \prod_t (1 - p_t) \),
 with \( p_t = k \cdot c \cdot \delta_t \). Using the cumulant generating
 function of the Poisson binomial distribution, this is approximated as: \[
 \mathbb{P}(\text{any exposure}) = 1 - \exp\left( \sum_t \log(1 - p_t)
 \right) \] Expanding the logarithm: \[ \sum_t \log(1 - p_t) =
 -\sum_{n=1}^\infty \frac{(k c)^n}{n} \sum_t (\delta_t)^n =
 -\sum_{n=1}^\infty \frac{(k c)^n}{n} B_n \] Let \( S(c) = \sum_{n=1}^4
 \frac{(k c)^n}{n} B_n \). Then: \[ \mathbb{P}(\text{any exposure}) \approx
 1 - e^{-S(c)} \] This is expanded as a power series in \( c \): \[ 1 -
 e^{-S(c)} = a_1 c + a_2 c^2 + a_3 c^3 + a_4 c^4 + \cdots \] The
 coefficients \( a_1, a_2, a_3, a_4 \) are computed using combinatorial
 identities from the Taylor expansion, then averaged over all contact
 probabilities \( k_{ij} \) and viral load profiles \( m \).

 <p>
 The final surrogate model is: \[ \hat{p}(c) = \overline{a_1} \cdot c +
 \overline{a_2} \cdot c^2 + \overline{a_3} \cdot c^3 + \overline{a_4} \cdot
 c^4 \] enabling \( O(1) \) evaluation during root-finding. This avoids
 repeated time-series computations, accelerating R₀ calibration while
 preserving accuracy for realistic parameter ranges.

 <p>
 The underlying distribution of exposures is a Poisson binomial with: \[
 \mathbb{E}\left[\sum_t X_t\right] = \sum_t p_t, \quad
 \mathrm{Var}\left[\sum_t X_t\right] = \sum_t p_t(1 - p_t), \] as
 referenced in the Poisson binomial distribution literature. The
 independence of daily exposure events justifies the additive structure of
 the cumulants used in the expansion.</div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="see-list-long">
<li><a href="https://stats.stackexchange.com/questions/93852/sum-of-bernoulli-variables-with-different-success-probabilities">Poisson
      Binomial Distribution</a></li>
</ul>
</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(double%5B%5D%5B%5D,double%5B%5D)" class="member-name-link">Estimator</a><wbr>(double[][]&nbsp;viralLoadProfiles,
 double[]&nbsp;contactProbabilities)</code></div>
<div class="col-last even-row-color">
<div class="block">Constructor that precomputes the necessary coefficients for the
 polynomial approximation of transmission probability.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#precomputeAverageCoefficients(double%5B%5D,double%5B%5D%5B%5D)" class="member-name-link">precomputeAverageCoefficients</a><wbr>(double[]&nbsp;kValues,
 double[][]&nbsp;bProfiles)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Precomputes the average polynomial coefficients that approximate the
 expected probability of transmission across all contact edges and viral
 load profiles.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(double[][],double[])">
<h3>Estimator</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.Estimator.html#line-151">Estimator</a></span><wbr><span class="parameters">(double[][]&nbsp;viralLoadProfiles,
 double[]&nbsp;contactProbabilities)</span></div>
<div class="block">Constructor that precomputes the necessary coefficients for the
 polynomial approximation of transmission probability.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>viralLoadProfiles</code> - A 100x100 array of viral load trajectories
                             (profiles x time)</dd>
<dd><code>contactProbabilities</code> - An array of contact probabilities for each
                             edge in the social network</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="precomputeAverageCoefficients(double[],double[][])">
<h3>precomputeAverageCoefficients</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.Estimator.html#line-226">precomputeAverageCoefficients</a></span><wbr><span class="parameters">(double[]&nbsp;kValues,
 double[][]&nbsp;bProfiles)</span></div>
<div class="block">Precomputes the average polynomial coefficients that approximate the
 expected probability of transmission across all contact edges and viral
 load profiles.

 <p>
 The goal is to approximate: \[ \bar{p}(c) = \frac{1}{E} \sum_{ij}
 \frac{1}{M} \sum_{m=1}^M \left(1 - \prod_{t=1}^T (1 - k_{ij} c
 \delta_t^{(m)})\right) \] using a quartic polynomial: \[ \bar{p}(c)
 \approx a_1 c + a_2 c^2 + a_3 c^3 + a_4 c^4 \]

 <p>
 Using the cumulant generating function of the Poisson binomial
 distribution of exposures, we expand: \[ \mathbb{P}(\text{any
 exposure}) = 1 - \exp\left( \sum_{t} \log(1 - k_{ij} c \delta_t^{(m)})
 \right) \approx 1 - \exp\left( -\sum_{n=1}^4 \frac{(k_{ij} c)^n}{n}
 B_n^{(m)} \right) \] Let \( S = \sum_{n=1}^4 s_n c^n \) with \( s_n =
 \frac{k_{ij}^n B_n^{(m)}}{n} \) . Then: \[ 1 - e^{-S} = s_1 c +
 \left(s_2 - \frac{s_1^2}{2}\right) c^2 + \left(s_3 - s_1 s_2 +
 \frac{s_1^3}{6}\right) c^3 + \cdots \]

 <p>
 However, the implementation uses an equivalent but algebraically
 reorganized expansion, where intermediate terms \( d_n = k_{ij} \cdot
 \frac{(-1)^{n+1} B_n^{(m)}}{n!} \) are used to construct the polynomial
 coefficients via combinatorial identities arising from the Taylor
 expansion of \( 1 - e^{-X} \) .

 <p>
 This method:
 <ul>
 <li>Iterates over all contact probabilities \( k_{ij} \)</li>
 <li>For each \( k_{ij} \) and profile \( m \) , computes local
 coefficients \( c_1, c_2, c_3, c_4 \)</li>
 <li>Averages them first over profiles (inner loop), then over edges
 (outer loop)</li>
 </ul>

 <p>
 The resulting cached coefficients \( \texttt{avg\_c1}, \dots,
 \texttt{avg\_c4} \) enable \( O(1) \) evaluation of the expected
 transmission probability in <code>fastPTransmission(double)</code>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>kValues</code> - Array of contact probabilities \( k_{ij} \) for each
                  edge in the social network</dd>
<dd><code>bProfiles</code> - Output of <code>computeBProfiles(double[][])</code>: \(
                  B_1, B_2, B_3, B_4 \) per profile</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2026. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>