<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (17) on Thu Feb 12 13:26:30 UTC 2026 -->
<title>Calibration (jpansim2 0.3.0 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2026-02-12">
<meta name="description" content="declaration: package: io.github.ai4ci.abm, class: Calibration">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<div class="about-language"><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/Calibration.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">io.github.ai4ci.abm</a></div>
<h1 title="Class Calibration" class="title">Class Calibration</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">io.github.ai4ci.abm.Calibration</div>
</div>
<section class="class-description" id="class-description">
<hr>
<object type="image/svg+xml" data="Calibration.svg"  style="max-width:60%;float:right;"></object>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-25">Calibration</a></span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Various utilities to calibrate model to real world observations.

 <p>
 Main purpose: provide helper functions to estimate contact rates, infer
 transmission parameters and compute network-based thresholds used during
 model calibration and sanity checks.</div>
<dl class="notes">
<dt>Author:</dt>
<dd>Rob Challen</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static class&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="Calibration.Estimator.html" class="type-name-link" title="class in io.github.ai4ci.abm">Calibration.Estimator</a></code></div>
<div class="col-last even-row-color">
<div class="block">An optimized estimator for the expected probability of transmission across
 a social network edge given a transmission parameter and viral load
 profiles.</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">Calibration</a>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#adjustR0(io.github.ai4ci.abm.Outbreak,double)" class="member-name-link">adjustR0</a><wbr>(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;o,
 double&nbsp;R0)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Adjusts the target R0 to account for network structure effects by
 normalizing against the maximum possible percolation threshold of a fully
 connected network with the same mean degree.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#averageContactDegree(io.github.ai4ci.abm.Outbreak)" class="member-name-link">averageContactDegree</a><wbr>(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;o)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Compute the average contact degree across the population.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#contactsPerPersonPerDay(io.github.ai4ci.abm.Outbreak)" class="member-name-link">contactsPerPersonPerDay</a><wbr>(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Estimate the average number of contacts per person per day based on the
 outbreak social network and individual mobility baselines.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#expectedExposuresPerInfection(io.github.ai4ci.abm.Outbreak,double%5B%5D%5B%5D,double)" class="member-name-link">expectedExposuresPerInfection</a><wbr>(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak,
 double[][]&nbsp;dd,
 double&nbsp;parameter)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Identifies for a given transmission parameter, the expected number of
 exposures per infection, given social network topology and baseline
 contact probability between agents.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#inferSeverityCutoff(io.github.ai4ci.abm.Outbreak,double)" class="member-name-link">inferSeverityCutoff</a><wbr>(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak,
 double&nbsp;infectionEventRatio)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Calibrate severity cutoffs for events based on probability.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#inferViralLoadTransmissionParameter(io.github.ai4ci.abm.Outbreak,double)" class="member-name-link">inferViralLoadTransmissionParameter</a><wbr>(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak,
 double&nbsp;R0)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">The translation and the in host model viral load and transmission
 probability is a function
 <a href="OutbreakBaseline.html#transmissibilityFromViralLoad(double,double)"><code>OutbreakBaseline.transmissibilityFromViralLoad(double, double)</code></a>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#inferViralLoadTransmissionParameter(io.github.ai4ci.abm.Outbreak,double%5B%5D%5B%5D,double)" class="member-name-link">inferViralLoadTransmissionParameter</a><wbr>(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak,
 double[][]&nbsp;dd,
 double&nbsp;R0)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Infer the viral load transmission parameter for a supplied viral load
 profile set.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#inferViralLoadTransmissionParameterQuick(io.github.ai4ci.abm.Outbreak,double)" class="member-name-link">inferViralLoadTransmissionParameterQuick</a><wbr>(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak,
 double&nbsp;R0)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Infers the viral load transmission parameter that achieves a target R₀
 using a fast, polynomial-based approximation.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#maxR0(io.github.ai4ci.abm.Outbreak)" class="member-name-link">maxR0</a><wbr>(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Compute the maximum achievable basic reproduction number (R0) for this
 network assuming transmission on every edge.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#networkDegreePerPerson(io.github.ai4ci.abm.Outbreak)" class="member-name-link">networkDegreePerPerson</a><wbr>(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;o)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Node (aka Person) temporal contact network degree based on probabilistic
 weighting of social network.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#percolationThreshold(io.github.ai4ci.abm.Outbreak)" class="member-name-link">percolationThreshold</a><wbr>(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;o)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Computes the percolation threshold of the probabilistic contact network
 using the second moment of the degree distribution.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static double</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#perEdgeTransmissionProbability(double,io.github.ai4ci.abm.Outbreak)" class="member-name-link">perEdgeTransmissionProbability</a><wbr>(double&nbsp;R0,
 <a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;o)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">As per Koch et al 2013, Edge removal in contact networks eqn 2</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>Calibration</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-25">Calibration</a></span>()</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="adjustR0(io.github.ai4ci.abm.Outbreak,double)">
<h3>adjustR0</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-320">adjustR0</a></span><wbr><span class="parameters">(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;o,
 double&nbsp;R0)</span></div>
<div class="block">Adjusts the target R0 to account for network structure effects by
 normalizing against the maximum possible percolation threshold of a fully
 connected network with the same mean degree.

 <p>
 The effective reproductive number in a network is constrained by its
 topology. The percolation threshold \( T_c = \langle k \rangle / (\langle
 k^2 \rangle - \langle k \rangle) \) determines the minimum
 transmissibility for an epidemic. In a fully connected network with
 homogeneous contact probability, \( \langle k^2 \rangle = \langle k
 \rangle^2 \), so: \[ T_{\text{max}} = \frac{\langle k \rangle}{\langle k
 \rangle^2 - \langle k \rangle} = \frac{1}{\langle k \rangle - 1} \]

 <p>
 This method computes the ratio of the actual percolation threshold \( T_c
 \) to \( T_{\text{max}} \), which captures how much the network structure
 reduces or enhances transmission potential. The adjusted \( R_0 \) is
 then: \[ R_0^{\text{adj}} = R_0 \cdot \frac{T_c}{T_{\text{max}}} \]

 <p>
 This adjustment ensures that the calibrated transmission parameter
 reflects only the biological mechanism (viral load → transmissibility),
 decoupled from network-specific structural effects. It allows for
 transferable parameter estimates across different population structures.

 <p>
 For example, a clustered or sparse network will have \( T_c >
 T_{\text{max}} \), leading to \( R_0^{\text{adj}} \lt R_0 \), meaning a
 higher intrinsic transmissibility is needed to achieve the same
 population-level \( R_0 \).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>o</code> - the outbreak configuration</dd>
<dd><code>R0</code> - the desired basic reproduction number in a well-mixed population</dd>
<dt>Returns:</dt>
<dd>the network-adjusted R0 that compensates for reduced connectivity</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="averageContactDegree(io.github.ai4ci.abm.Outbreak)">
<h3>averageContactDegree</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-337">averageContactDegree</a></span><wbr><span class="parameters">(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;o)</span></div>
<div class="block">Compute the average contact degree across the population.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>o</code> - the outbreak providing the social network</dd>
<dt>Returns:</dt>
<dd>the average node degree (expected contacts per person)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="contactsPerPersonPerDay(io.github.ai4ci.abm.Outbreak)">
<h3>contactsPerPersonPerDay</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-349">contactsPerPersonPerDay</a></span><wbr><span class="parameters">(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak)</span></div>
<div class="block">Estimate the average number of contacts per person per day based on the
 outbreak social network and individual mobility baselines.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>outbreak</code> - the outbreak containing the social network and people</dd>
<dt>Returns:</dt>
<dd>the mean number of contacts per person per day</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="expectedExposuresPerInfection(io.github.ai4ci.abm.Outbreak,double[][],double)">
<h3>expectedExposuresPerInfection</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-376">expectedExposuresPerInfection</a></span><wbr><span class="parameters">(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak,
 double[][]&nbsp;dd,
 double&nbsp;parameter)</span></div>
<div class="block">Identifies for a given transmission parameter, the expected number of
 exposures per infection, given social network topology and baseline
 contact probability between agents.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>outbreak</code> - the outbreak providing the social network and population</dd>
<dd><code>dd</code> - an array of viral load profiles (profiles x time)</dd>
<dd><code>parameter</code> - the transmission parameter to evaluate (scales
                  transmissibility)</dd>
<dt>Returns:</dt>
<dd>the expected number of exposures generated by a single infection</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="inferSeverityCutoff(io.github.ai4ci.abm.Outbreak,double)">
<h3>inferSeverityCutoff</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-438">inferSeverityCutoff</a></span><wbr><span class="parameters">(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak,
 double&nbsp;infectionEventRatio)</span></div>
<div class="block">Calibrate severity cutoffs for events based on probability. Events might
 be hospitalisation, death, and be relative to infection so always a number
 less than 1. A small IFR correlates with a high cutoff for severity based
 on population severity distribution. Therefore for a 0.01 IFR we cut-off
 at the 0.99 quantile for severity.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>outbreak</code> - the outbreak</dd>
<dd><code>infectionEventRatio</code> - a ratio between infected and those infected and
                            e.g. hospitalised.</dd>
<dt>Returns:</dt>
<dd>the severity cutoff value (unit interval) corresponding to the
         supplied ratio</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="inferViralLoadTransmissionParameter(io.github.ai4ci.abm.Outbreak,double)">
<h3>inferViralLoadTransmissionParameter</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-476">inferViralLoadTransmissionParameter</a></span><wbr><span class="parameters">(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak,
 double&nbsp;R0)</span></div>
<div class="block">The translation and the in host model viral load and transmission
 probability is a function
 <a href="OutbreakBaseline.html#transmissibilityFromViralLoad(double,double)"><code>OutbreakBaseline.transmissibilityFromViralLoad(double, double)</code></a>.
 The in host viral load model has been run for a range of different
 parameters and the average response held in the viral load profile. The
 probability of a contact that generates one or more exposures over the
 whole infective period is calculated. The R0 value is the population
 average of the sum of each individuals secondary exposures. This is solved
 for R0 to get a parameter of the function that converts viral load to
 transmission probability per day. This ignores the possibility of multiple
 exposure by different people, but this is OK for R0 calibration.

 <br>
 The calculation requires a set of viral load profiles based on a random
 sampling of 100 average people, exposed to a 1 unit dose of virus which is
 handled by
 <a href="../config/inhost/InHostConfiguration.html#getViralLoadProfile(io.github.ai4ci.config.execution.ExecutionConfiguration,int,int)"><code>the in host model configuration</code></a></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>outbreak</code> - the outbreak configuration to use for calibration</dd>
<dd><code>R0</code> - the target basic reproduction number to match</dd>
<dt>Returns:</dt>
<dd>the inferred transmission parameter</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="inferViralLoadTransmissionParameter(io.github.ai4ci.abm.Outbreak,double[][],double)">
<h3>inferViralLoadTransmissionParameter</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-497">inferViralLoadTransmissionParameter</a></span><wbr><span class="parameters">(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak,
 double[][]&nbsp;dd,
 double&nbsp;R0)</span></div>
<div class="block">Infer the viral load transmission parameter for a supplied viral load
 profile set.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>outbreak</code> - the outbreak configuration providing network and execution
                 settings</dd>
<dd><code>dd</code> - an array of viral load profiles (profiles x time)</dd>
<dd><code>R0</code> - the target basic reproduction number to match</dd>
<dt>Returns:</dt>
<dd>the inferred transmission parameter</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="inferViralLoadTransmissionParameterQuick(io.github.ai4ci.abm.Outbreak,double)">
<h3>inferViralLoadTransmissionParameterQuick</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-557">inferViralLoadTransmissionParameterQuick</a></span><wbr><span class="parameters">(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak,
 double&nbsp;R0)</span></div>
<div class="block">Infers the viral load transmission parameter that achieves a target R₀
 using a fast, polynomial-based approximation.

 <p>
 This method is an optimized alternative to
 <a href="#inferViralLoadTransmissionParameter(io.github.ai4ci.abm.Outbreak,double)"><code>inferViralLoadTransmissionParameter(Outbreak, double)</code></a>. It uses
 the <a href="Calibration.Estimator.html" title="class in io.github.ai4ci.abm"><code>Calibration.Estimator</code></a> class to approximate the expected number of
 secondary exposures per infection via a precomputed quartic polynomial in
 the transmission parameter. The approximation is derived from a series
 expansion of the probability of at least one exposure over time,
 accounting for variable daily transmissibility and contact probability.

 <p>
 The method adjusts the target R₀ for network structure using
 <a href="#adjustR0(io.github.ai4ci.abm.Outbreak,double)"><code>adjustR0(Outbreak, double)</code></a> and solves for the transmission
 parameter using Brent's method. The result is significantly faster than
 the full simulation-based approach, making it suitable for repeated
 calibration tasks.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>outbreak</code> - the outbreak configuration, including social network and
                 viral load profiles</dd>
<dd><code>R0</code> - the desired basic reproduction number to calibrate to</dd>
<dt>Returns:</dt>
<dd>the inferred transmission parameter (scales transmissibility per
         unit viral load above 1.0)</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/RuntimeException.html" title="class or interface in java.lang" class="external-link">RuntimeException</a></code> - if no solution is found within the valid
                          parameter range [0, 0.1]</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="maxR0(io.github.ai4ci.abm.Outbreak)">
<h3>maxR0</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-606">maxR0</a></span><wbr><span class="parameters">(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;outbreak)</span></div>
<div class="block">Compute the maximum achievable basic reproduction number (R0) for this
 network assuming transmission on every edge.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>outbreak</code> - the outbreak configuration with network and viral profiles</dd>
<dt>Returns:</dt>
<dd>the maximum R0 the network topology can support</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="networkDegreePerPerson(io.github.ai4ci.abm.Outbreak)">
<h3>networkDegreePerPerson</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double[]</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-625">networkDegreePerPerson</a></span><wbr><span class="parameters">(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;o)</span></div>
<div class="block">Node (aka Person) temporal contact network degree based on probabilistic
 weighting of social network. This is a mean estimate of the degree of
 contact network for each node based on a single bernouilli trial for each
 social network edge with a per edge probability. The distribution would be
 the sum of bernoullis with different probabilities which is a Poisson
 Binomial Distribution
 </div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>o</code> - the outbreak providing the social network and people</dd>
<dt>Returns:</dt>
<dd>array of per-person expected contact degrees</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="percolationThreshold(io.github.ai4ci.abm.Outbreak)">
<h3>percolationThreshold</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-699">percolationThreshold</a></span><wbr><span class="parameters">(<a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;o)</span></div>
<div class="block">Computes the percolation threshold of the probabilistic contact network
 using the second moment of the degree distribution.

 <p>
 In epidemic percolation theory, the threshold for sustained transmission
 is determined by the structure of the contact network. For a random
 network, the critical transmissibility \( T_c \) at which a giant
 connected component emerges is: \[ T_c = \frac{\langle k \rangle}{\langle
 k^2 \rangle - \langle k \rangle} \] where \( \langle k \rangle \) is the
 mean degree and \( \langle k^2 \rangle \) is the second moment of the
 degree distribution.

 <p>
 In this model, contact between agents is probabilistic, so the degree of
 each node is a sum of independent Bernoulli variables with different
 success probabilities \( p_{ij} \), forming a <i>Poisson binomial
 distribution</i>. The expected degree of node \( i \) is: \[
 \mathbb{E}[k_i] = \sum_{j} p_{ij} \] and the variance is: \[
 \mathrm{Var}(k_i) = \sum_{j} p_{ij}(1 - p_{ij}) \] as per the properties
 of the Poisson binomial distribution.

 <p>
 The second moment \( \langle k^2 \rangle \) is estimated as: \[ \langle
 k^2 \rangle = \langle k \rangle^2 + \langle \mathrm{Var}(k_i) \rangle \]
 where the latter term accounts for the excess variance due to
 heterogeneous \( p_{ij} \).

 <p>
 This method computes the average percolation threshold across the
 population, reflecting the network's susceptibility to epidemic spread. A
 lower threshold implies higher connectivity and easier outbreak
 propagation.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>o</code> - the outbreak configuration, including the social network and
          agent mobility</dd>
<dt>Returns:</dt>
<dd>the percolation threshold \(T_c\) for the network</dd>
<dt>See Also:</dt>
<dd>
<ul class="see-list-long">
<li><a href="https://stats.stackexchange.com/questions/93852/sum-of-bernoulli-variables-with-different-success-probabilities">Poisson
      Binomial Distribution</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="perEdgeTransmissionProbability(double,io.github.ai4ci.abm.Outbreak)">
<h3>perEdgeTransmissionProbability</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name"><a href="../../../../src-html/io/github/ai4ci/abm/Calibration.html#line-734">perEdgeTransmissionProbability</a></span><wbr><span class="parameters">(double&nbsp;R0,
 <a href="Outbreak.html" title="interface in io.github.ai4ci.abm">Outbreak</a>&nbsp;o)</span></div>
<div class="block">As per Koch et al 2013, Edge removal in contact networks eqn 2</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>R0</code> - the desired basic reproduction number</dd>
<dd><code>o</code> - the outbreak providing network information</dd>
<dt>Returns:</dt>
<dd>the per-edge transmission probability corresponding to R0</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2026. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>